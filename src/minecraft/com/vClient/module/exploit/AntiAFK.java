package com.vClient.module.exploit;

import com.vClient.event.EventTarget;
import com.vClient.event.events.EventPreMotionUpdate;
import com.vClient.module.Category;
import com.vClient.module.Module;
import com.vClient.util.ClockUtil;
import com.vClient.vClient;
import de.Hero.settings.Setting;
import org.lwjgl.input.Keyboard;

public class AntiAFK extends Module {
    private final ClockUtil clock = new ClockUtil();
    private final ClockUtil period = new ClockUtil();

    public AntiAFK() {
        super("AntiAFK", Keyboard.CHAR_NONE, Category.EXPLOIT, "Prevent kick for being AFK.");
    }

    @Override
    public void setup() {
        vClient.instance.settingsManager.rSetting(new Setting("Interval", this, 20, 5, 60, true));
    }

    @EventTarget
    public void onPre(EventPreMotionUpdate event) {
        clock.updateTime();
        period.updateTime();
        if (clock.elapsedTime() / 1000L >= vClient.instance.settingsManager.getSettingByName("Interval").getValDouble()) {
            event.setYaw(mc.thePlayer.rotationYaw + 60f);
            mc.thePlayer.rotationYaw += 60f;
            mc.gameSettings.keyBindForward.pressed = true;
            clock.resetTime();
            period.resetTime();
        }
        if (period.elapsedTime() > 1000) {
            mc.gameSettings.keyBindForward.pressed = false;
            period.resetTime();
        }
    }

    @Override
    public void onDisable() {
        mc.gameSettings.keyBindForward.pressed = false;
        super.onDisable();
    }
}
